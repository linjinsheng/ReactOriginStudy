{"ast":null,"code":"import _classCallCheck from \"/Users/linjinsheng/Desktop/ReactOriginStudy/\\u7B2C01\\u7AE0 \\u7406\\u5FF5\\u7BC7/1.1 \\u5982\\u4F55\\u5B66\\u4E60React\\u6E90\\u7801/concurrent/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/linjinsheng/Desktop/ReactOriginStudy/\\u7B2C01\\u7AE0 \\u7406\\u5FF5\\u7BC7/1.1 \\u5982\\u4F55\\u5B66\\u4E60React\\u6E90\\u7801/concurrent/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/linjinsheng/Desktop/ReactOriginStudy/\\u7B2C01\\u7AE0 \\u7406\\u5FF5\\u7BC7/1.1 \\u5982\\u4F55\\u5B66\\u4E60React\\u6E90\\u7801/concurrent/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/linjinsheng/Desktop/ReactOriginStudy/\\u7B2C01\\u7AE0 \\u7406\\u5FF5\\u7BC7/1.1 \\u5982\\u4F55\\u5B66\\u4E60React\\u6E90\\u7801/concurrent/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/linjinsheng/Desktop/ReactOriginStudy/\\u7B2C01\\u7AE0 \\u7406\\u5FF5\\u7BC7/1.1 \\u5982\\u4F55\\u5B66\\u4E60React\\u6E90\\u7801/concurrent/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/linjinsheng/Desktop/ReactOriginStudy/\\u7B2C01\\u7AE0 \\u7406\\u5FF5\\u7BC7/1.1 \\u5982\\u4F55\\u5B66\\u4E60React\\u6E90\\u7801/concurrent/src/index.js\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { unstable_scheduleCallback } from \"scheduler\";\nimport _ from \"lodash\";\nimport Charts from \"./Charts\";\nimport Clock from \"./Clock\";\nimport \"./styles.css\";\nvar ConcurrentMode = React.unstable_ConcurrentMode,\n    Component = React.Component,\n    Suspense = React.Suspense,\n    PureComponent = React.PureComponent;\nvar createRoot = ReactDOM.unstable_createRoot,\n    flushSync = ReactDOM.flushSync;\nvar cachedData = new Map();\n\nvar App = /*#__PURE__*/function (_PureComponent) {\n  _inherits(App, _PureComponent);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      value: \"\",\n      strategy: \"sync\",\n      showDemo: true,\n      showClock: false\n    };\n\n    _this.handleChartClick = function (e) {\n      if (_this.state.showDemo) {\n        if (e.shiftKey) {\n          _this.setState({\n            showDemo: false\n          });\n        }\n\n        return;\n      }\n\n      if (_this.state.strategy !== \"async\") {\n        flushSync(function () {\n          _this.setState(function (state) {\n            return {\n              showDemo: !state.showDemo\n            };\n          });\n        });\n        return;\n      }\n\n      if (_this._ignoreClick) {\n        return;\n      }\n\n      _this._ignoreClick = true;\n      unstable_scheduleCallback(function () {\n        _this.setState({\n          showDemo: true\n        }, function () {\n          _this._ignoreClick = false;\n        });\n      });\n    };\n\n    _this.debouncedHandleChange = _.debounce(function (value) {\n      if (_this.state.strategy === \"debounced\") {\n        flushSync(function () {\n          _this.setState({\n            value: value\n          });\n        });\n      }\n    }, 1000);\n    _this.throttleHandleChange = _.throttle(function (value) {\n      if (_this.state.strategy === \"throttle\") {\n        flushSync(function () {\n          _this.setState({\n            value: value\n          });\n        });\n      }\n    }, 1000);\n\n    _this.handleChange = function (e) {\n      var value = e.target.value;\n      var strategy = _this.state.strategy;\n\n      switch (strategy) {\n        case \"sync\":\n          _this.setState({\n            value: value\n          });\n\n          break;\n\n        case \"setTimeout\":\n          setTimeout(function () {\n            _this.setState({\n              value: value\n            });\n          });\n          break;\n\n        case \"throttle\":\n          _this.throttleHandleChange(value);\n\n          break;\n\n        case \"debounced\":\n          _this.debouncedHandleChange(value);\n\n          break;\n\n        case \"async\":\n          unstable_scheduleCallback(function () {\n            _this.setState({\n              value: value\n            });\n          });\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"getStreamData\",\n    // Random data for the chart\n    value: function getStreamData(input) {\n      if (cachedData.has(input)) {\n        return cachedData.get(input);\n      }\n\n      var multiplier = input.length !== 0 ? input.length : 1;\n      var complexity = parseInt(window.location.search.substring(1), 10) / 100 * 25 || 25;\n\n      var data = _.range(5).map(function (t) {\n        return _.range(complexity * multiplier).map(function (j, i) {\n          return {\n            x: j,\n            y: (t + 1) * _.random(0, 255)\n          };\n        });\n      });\n\n      cachedData.set(input, data);\n      return data;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      window.addEventListener(\"keydown\", function (e) {\n        if (e.key.toLowerCase() === \"?\") {\n          e.preventDefault();\n\n          _this2.setState(function (state) {\n            return {\n              showClock: !state.showClock\n            };\n          });\n        }\n      });\n    }\n  }, {\n    key: \"renderOption\",\n    value: function renderOption(strategy, label) {\n      var _this3 = this;\n\n      var currentStrategy = this.state.strategy;\n      return /*#__PURE__*/React.createElement(\"label\", {\n        className: strategy === currentStrategy ? \"selected\" : null,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"radio\",\n        checked: strategy === currentStrategy,\n        onChange: function onChange() {\n          _this3.setState({\n            strategy: strategy\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 9\n        }\n      }), label);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var showClock = this.state.showClock;\n      var data = this.getStreamData(this.state.value);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"rendering\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 9\n        }\n      }, this.renderOption(\"sync\", \"同步更新\"), this.renderOption(\"debounced\", \"Debounced\"), this.renderOption(\"throttle\", \"Throttle\"), this.renderOption(\"async\", \"异步更新\")), /*#__PURE__*/React.createElement(\"input\", {\n        className: \"input \" + this.state.strategy,\n        placeholder: \"longer input \\u2192 more components and DOM nodes\",\n        onChange: this.handleChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"demo\",\n        onClick: this.handleChartClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 9\n        }\n      }, this.state.showDemo && /*#__PURE__*/React.createElement(Charts, {\n        data: data,\n        onClick: this.handleChartClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          display: showClock ? \"block\" : \"none\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Clock, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 13\n        }\n      }))));\n    }\n  }]);\n\n  return App;\n}(PureComponent);\n\ncreateRoot(document.getElementById(\"root\")).render( /*#__PURE__*/React.createElement(ConcurrentMode, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 176,\n    columnNumber: 3\n  }\n}, /*#__PURE__*/React.createElement(App, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 5\n  }\n})));","map":{"version":3,"sources":["/Users/linjinsheng/Desktop/ReactOriginStudy/第01章 理念篇/1.1 如何学习React源码/concurrent/src/index.js"],"names":["React","ReactDOM","unstable_scheduleCallback","_","Charts","Clock","ConcurrentMode","unstable_ConcurrentMode","Component","Suspense","PureComponent","createRoot","unstable_createRoot","flushSync","cachedData","Map","App","state","value","strategy","showDemo","showClock","handleChartClick","e","shiftKey","setState","_ignoreClick","debouncedHandleChange","debounce","throttleHandleChange","throttle","handleChange","target","setTimeout","input","has","get","multiplier","length","complexity","parseInt","window","location","search","substring","data","range","map","t","j","i","x","y","random","set","addEventListener","key","toLowerCase","preventDefault","label","currentStrategy","getStreamData","renderOption","display","document","getElementById","render"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,SAASC,yBAAT,QAA0C,WAA1C;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAO,cAAP;IAG2BC,c,GAIvBN,K,CAJFO,uB;IACAC,S,GAGER,K,CAHFQ,S;IACAC,Q,GAEET,K,CAFFS,Q;IACAC,a,GACEV,K,CADFU,a;IAE2BC,U,GAA0BV,Q,CAA/CW,mB;IAAiCC,S,GAAcZ,Q,CAAdY,S;AAGzC,IAAIC,UAAU,GAAG,IAAIC,GAAJ,EAAjB;;IAEMC,G;;;;;;;;;;;;;;;UACJC,K,GAAQ;AACNC,MAAAA,KAAK,EAAE,EADD;AAENC,MAAAA,QAAQ,EAAE,MAFJ;AAGNC,MAAAA,QAAQ,EAAE,IAHJ;AAINC,MAAAA,SAAS,EAAE;AAJL,K;;UAsCRC,gB,GAAmB,UAAAC,CAAC,EAAI;AACtB,UAAI,MAAKN,KAAL,CAAWG,QAAf,EAAyB;AACvB,YAAIG,CAAC,CAACC,QAAN,EAAgB;AACd,gBAAKC,QAAL,CAAc;AAAEL,YAAAA,QAAQ,EAAE;AAAZ,WAAd;AACD;;AACD;AACD;;AACD,UAAI,MAAKH,KAAL,CAAWE,QAAX,KAAwB,OAA5B,EAAqC;AACnCN,QAAAA,SAAS,CAAC,YAAM;AACd,gBAAKY,QAAL,CAAc,UAAAR,KAAK;AAAA,mBAAK;AACtBG,cAAAA,QAAQ,EAAE,CAACH,KAAK,CAACG;AADK,aAAL;AAAA,WAAnB;AAGD,SAJQ,CAAT;AAKA;AACD;;AACD,UAAI,MAAKM,YAAT,EAAuB;AACrB;AACD;;AACD,YAAKA,YAAL,GAAoB,IAApB;AAEAxB,MAAAA,yBAAyB,CAAC,YAAM;AAC9B,cAAKuB,QAAL,CAAc;AAAEL,UAAAA,QAAQ,EAAE;AAAZ,SAAd,EAAkC,YAAM;AACtC,gBAAKM,YAAL,GAAoB,KAApB;AACD,SAFD;AAGD,OAJwB,CAAzB;AAKD,K;;UAEDC,qB,GAAwBxB,CAAC,CAACyB,QAAF,CAAW,UAAAV,KAAK,EAAI;AAC1C,UAAI,MAAKD,KAAL,CAAWE,QAAX,KAAwB,WAA5B,EAAyC;AACvCN,QAAAA,SAAS,CAAC,YAAM;AACd,gBAAKY,QAAL,CAAc;AAAEP,YAAAA,KAAK,EAAEA;AAAT,WAAd;AACD,SAFQ,CAAT;AAGD;AACF,KANuB,EAMrB,IANqB,C;UAQxBW,oB,GAAuB1B,CAAC,CAAC2B,QAAF,CAAW,UAAAZ,KAAK,EAAI;AACzC,UAAI,MAAKD,KAAL,CAAWE,QAAX,KAAwB,UAA5B,EAAwC;AACtCN,QAAAA,SAAS,CAAC,YAAM;AACd,gBAAKY,QAAL,CAAc;AAAEP,YAAAA,KAAK,EAAEA;AAAT,WAAd;AACD,SAFQ,CAAT;AAGD;AACF,KANsB,EAMpB,IANoB,C;;UAwBvBa,Y,GAAe,UAAAR,CAAC,EAAI;AAClB,UAAML,KAAK,GAAGK,CAAC,CAACS,MAAF,CAASd,KAAvB;AADkB,UAEVC,QAFU,GAEG,MAAKF,KAFR,CAEVE,QAFU;;AAGlB,cAAQA,QAAR;AACE,aAAK,MAAL;AACE,gBAAKM,QAAL,CAAc;AAAEP,YAAAA,KAAK,EAALA;AAAF,WAAd;;AACA;;AACF,aAAK,YAAL;AACEe,UAAAA,UAAU,CAAC,YAAM;AACf,kBAAKR,QAAL,CAAc;AAAEP,cAAAA,KAAK,EAALA;AAAF,aAAd;AACD,WAFS,CAAV;AAGA;;AACF,aAAK,UAAL;AACE,gBAAKW,oBAAL,CAA0BX,KAA1B;;AACA;;AACF,aAAK,WAAL;AACE,gBAAKS,qBAAL,CAA2BT,KAA3B;;AACA;;AACF,aAAK,OAAL;AACEhB,UAAAA,yBAAyB,CAAC,YAAM;AAC9B,kBAAKuB,QAAL,CAAc;AAAEP,cAAAA,KAAK,EAALA;AAAF,aAAd;AACD,WAFwB,CAAzB;AAGA;;AACF;AACE;AArBJ;AAuBD,K;;;;;;;AApHD;kCACcgB,K,EAAO;AACnB,UAAIpB,UAAU,CAACqB,GAAX,CAAeD,KAAf,CAAJ,EAA2B;AACzB,eAAOpB,UAAU,CAACsB,GAAX,CAAeF,KAAf,CAAP;AACD;;AACD,UAAMG,UAAU,GAAGH,KAAK,CAACI,MAAN,KAAiB,CAAjB,GAAqBJ,KAAK,CAACI,MAA3B,GAAoC,CAAvD;AACA,UAAMC,UAAU,GACbC,QAAQ,CAACC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuBC,SAAvB,CAAiC,CAAjC,CAAD,EAAsC,EAAtC,CAAR,GAAoD,GAArD,GAA4D,EAA5D,IAAkE,EADpE;;AAEA,UAAMC,IAAI,GAAG1C,CAAC,CAAC2C,KAAF,CAAQ,CAAR,EAAWC,GAAX,CAAe,UAAAC,CAAC;AAAA,eAC3B7C,CAAC,CAAC2C,KAAF,CAAQP,UAAU,GAAGF,UAArB,EAAiCU,GAAjC,CAAqC,UAACE,CAAD,EAAIC,CAAJ,EAAU;AAC7C,iBAAO;AACLC,YAAAA,CAAC,EAAEF,CADE;AAELG,YAAAA,CAAC,EAAE,CAACJ,CAAC,GAAG,CAAL,IAAU7C,CAAC,CAACkD,MAAF,CAAS,CAAT,EAAY,GAAZ;AAFR,WAAP;AAID,SALD,CAD2B;AAAA,OAAhB,CAAb;;AAQAvC,MAAAA,UAAU,CAACwC,GAAX,CAAepB,KAAf,EAAsBW,IAAtB;AACA,aAAOA,IAAP;AACD;;;wCAEmB;AAAA;;AAClBJ,MAAAA,MAAM,CAACc,gBAAP,CAAwB,SAAxB,EAAmC,UAAAhC,CAAC,EAAI;AACtC,YAAIA,CAAC,CAACiC,GAAF,CAAMC,WAAN,OAAwB,GAA5B,EAAiC;AAC/BlC,UAAAA,CAAC,CAACmC,cAAF;;AACA,UAAA,MAAI,CAACjC,QAAL,CAAc,UAAAR,KAAK;AAAA,mBAAK;AACtBI,cAAAA,SAAS,EAAE,CAACJ,KAAK,CAACI;AADI,aAAL;AAAA,WAAnB;AAGD;AACF,OAPD;AAQD;;;iCA6CYF,Q,EAAUwC,K,EAAO;AAAA;;AAAA,UACVC,eADU,GACU,KAAK3C,KADf,CACpBE,QADoB;AAE5B,0BACE;AAAO,QAAA,SAAS,EAAEA,QAAQ,KAAKyC,eAAb,GAA+B,UAA/B,GAA4C,IAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AACE,QAAA,IAAI,EAAC,OADP;AAEE,QAAA,OAAO,EAAEzC,QAAQ,KAAKyC,eAFxB;AAGE,QAAA,QAAQ,EAAE,oBAAM;AACd,UAAA,MAAI,CAACnC,QAAL,CAAc;AAAEN,YAAAA,QAAQ,EAARA;AAAF,WAAd;AACD,SALH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAQGwC,KARH,CADF;AAYD;;;6BA8BQ;AAAA,UACCtC,SADD,GACe,KAAKJ,KADpB,CACCI,SADD;AAEP,UAAMwB,IAAI,GAAG,KAAKgB,aAAL,CAAmB,KAAK5C,KAAL,CAAWC,KAA9B,CAAb;AACA,0BACE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAK4C,YAAL,CAAkB,MAAlB,EAA0B,MAA1B,CADH,EAEG,KAAKA,YAAL,CAAkB,WAAlB,EAA+B,WAA/B,CAFH,EAGG,KAAKA,YAAL,CAAkB,UAAlB,EAA8B,UAA9B,CAHH,EAIG,KAAKA,YAAL,CAAkB,OAAlB,EAA2B,MAA3B,CAJH,CADF,eAOE;AACE,QAAA,SAAS,EAAE,WAAW,KAAK7C,KAAL,CAAWE,QADnC;AAEE,QAAA,WAAW,EAAC,mDAFd;AAGE,QAAA,QAAQ,EAAE,KAAKY,YAHjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPF,eAYE;AAAK,QAAA,SAAS,EAAC,MAAf;AAAsB,QAAA,OAAO,EAAE,KAAKT,gBAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKL,KAAL,CAAWG,QAAX,iBACC,oBAAC,MAAD;AAAQ,QAAA,IAAI,EAAEyB,IAAd;AAAoB,QAAA,OAAO,EAAE,KAAKvB,gBAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFJ,eAIE;AAAK,QAAA,KAAK,EAAE;AAAEyC,UAAAA,OAAO,EAAE1C,SAAS,GAAG,OAAH,GAAa;AAAjC,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAJF,CAZF,CADF;AAuBD;;;;EAxJeX,a;;AA2JlBC,UAAU,CAACqD,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAAD,CAAV,CAA4CC,MAA5C,eACE,oBAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EADF,CADF","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { unstable_scheduleCallback } from \"scheduler\";\nimport _ from \"lodash\";\nimport Charts from \"./Charts\";\nimport Clock from \"./Clock\";\nimport \"./styles.css\";\n\nconst {\n  unstable_ConcurrentMode: ConcurrentMode,\n  Component,\n  Suspense,\n  PureComponent\n} = React;\nconst { unstable_createRoot: createRoot, flushSync } = ReactDOM;\n\n\nlet cachedData = new Map();\n\nclass App extends PureComponent {\n  state = {\n    value: \"\",\n    strategy: \"sync\",\n    showDemo: true,\n    showClock: false\n  };\n\n  // Random data for the chart\n  getStreamData(input) {\n    if (cachedData.has(input)) {\n      return cachedData.get(input);\n    }\n    const multiplier = input.length !== 0 ? input.length : 1;\n    const complexity =\n      (parseInt(window.location.search.substring(1), 10) / 100) * 25 || 25;\n    const data = _.range(5).map(t =>\n      _.range(complexity * multiplier).map((j, i) => {\n        return {\n          x: j,\n          y: (t + 1) * _.random(0, 255)\n        };\n      })\n    );\n    cachedData.set(input, data);\n    return data;\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"keydown\", e => {\n      if (e.key.toLowerCase() === \"?\") {\n        e.preventDefault();\n        this.setState(state => ({\n          showClock: !state.showClock\n        }));\n      }\n    });\n  }\n\n  handleChartClick = e => {\n    if (this.state.showDemo) {\n      if (e.shiftKey) {\n        this.setState({ showDemo: false });\n      }\n      return;\n    }\n    if (this.state.strategy !== \"async\") {\n      flushSync(() => {\n        this.setState(state => ({\n          showDemo: !state.showDemo\n        }));\n      });\n      return;\n    }\n    if (this._ignoreClick) {\n      return;\n    }\n    this._ignoreClick = true;\n\n    unstable_scheduleCallback(() => {\n      this.setState({ showDemo: true }, () => {\n        this._ignoreClick = false;\n      });\n    });\n  };\n\n  debouncedHandleChange = _.debounce(value => {\n    if (this.state.strategy === \"debounced\") {\n      flushSync(() => {\n        this.setState({ value: value });\n      });\n    }\n  }, 1000);\n\n  throttleHandleChange = _.throttle(value => {\n    if (this.state.strategy === \"throttle\") {\n      flushSync(() => {\n        this.setState({ value: value });\n      });\n    }\n  }, 1000);\n\n  renderOption(strategy, label) {\n    const { strategy: currentStrategy } = this.state;\n    return (\n      <label className={strategy === currentStrategy ? \"selected\" : null}>\n        <input\n          type=\"radio\"\n          checked={strategy === currentStrategy}\n          onChange={() => {\n            this.setState({ strategy });\n          }}\n        />\n        {label}\n      </label>\n    );\n  }\n\n  handleChange = e => {\n    const value = e.target.value;\n    const { strategy } = this.state;\n    switch (strategy) {\n      case \"sync\":\n        this.setState({ value });\n        break;\n      case \"setTimeout\":\n        setTimeout(() => {\n          this.setState({ value });\n        });\n        break;\n      case \"throttle\":\n        this.throttleHandleChange(value);\n        break;\n      case \"debounced\":\n        this.debouncedHandleChange(value);\n        break;\n      case \"async\":\n        unstable_scheduleCallback(() => {\n          this.setState({ value });\n        });\n        break;\n      default:\n        break;\n    }\n  };\n\n  render() {\n    const { showClock } = this.state;\n    const data = this.getStreamData(this.state.value);\n    return (\n      <div className=\"container\">\n        <div className=\"rendering\">\n          {this.renderOption(\"sync\", \"同步更新\")}\n          {this.renderOption(\"debounced\", \"Debounced\")}\n          {this.renderOption(\"throttle\", \"Throttle\")}\n          {this.renderOption(\"async\", \"异步更新\")}\n        </div>\n        <input\n          className={\"input \" + this.state.strategy}\n          placeholder=\"longer input → more components and DOM nodes\"\n          onChange={this.handleChange}\n        />\n        <div className=\"demo\" onClick={this.handleChartClick}>\n          {this.state.showDemo && (\n            <Charts data={data} onClick={this.handleChartClick} />\n          )}\n          <div style={{ display: showClock ? \"block\" : \"none\" }}>\n            <Clock />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\ncreateRoot(document.getElementById(\"root\")).render(\n  <ConcurrentMode>\n    <App />\n  </ConcurrentMode>\n);\n"]},"metadata":{},"sourceType":"module"}